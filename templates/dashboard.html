<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8">
  <title>Adminpanel â€“ OmvÃ¤rldskollen</title>
  <style>
    table { border-collapse: collapse; width: 100%; }
    th, td { padding: 0.5em; border: 1px solid #ccc; }
    th { background: #eee; }
    button.emoji-button {
      background: none;
      border: none;
      font-size: 1.2em;
      cursor: pointer;
      margin: 0 4px;
    }
    button.emoji-button:hover {
      transform: scale(1.2);
    }
    .status-box {
      background: #f9f9f9;
      padding: 1em;
      border: 1px solid #ccc;
      border-radius: 8px;
      margin-bottom: 1em;
    }
  </style>
  <script>
    function confirmAction(url, message) {
      if (confirm(message)) {
        fetch(url)
          .then(response => response.text())
          .then(data => alert(data))
          .catch(error => alert("Fel uppstod: " + error));
      }
    }
  </script>
</head>
<body style="font-family:sans-serif; padding:2em; max-width:1000px; margin:auto;">
  <h1>ğŸ“Š Adminpanel â€“ OmvÃ¤rldskollen</h1>

  <div class="status-box">
    <p><strong>Automatisering:</strong> {{ 'PÃ¥ âœ…' if auto_mode else 'Av â›”ï¸' }}</p>
    <p><strong>TillÃ¥tna klockslag:</strong> {{ scheduled }}</p>
    <p><strong>Manuell kÃ¶rning:</strong> {{ 'TillÃ¥ten ğŸŸ¢' if manual_allowed else 'Inte tillÃ¥ten ğŸ”´' }}</p>
    <a href="/toggle"><button>VÃ¤xla global automatisering</button></a>
    <a href="/run"><button style="margin-left: 1em;">KÃ¶r fÃ¶r alla nu â–¶ï¸</button></a>
  </div>

  <h2>AnvÃ¤ndare</h2>
  <table>
    <tr>
      <th>Namn</th>
      <th>E-post</th>
      <th>Feeds</th>
      <th>Nyckelord</th>
      <th>Schema</th>
      <th>Aktiv</th>
      <th>Ã…tgÃ¤rder</th>
    </tr>
    {% for user in users %}
    <tr>
      <td>{{ user['Name'] }}</td>
      <td>{{ user['Email'] }}</td>
      <td>{{ user['Feeds'] }}</td>
      <td>{{ user['Keywords'] }}</td>
      <td>{{ user['Schedule'] }}</td>
      <td>{{ 'âœ…' if user['Active']|lower == 'true' else 'â›”ï¸' }}</td>
      <td>
        <button class="emoji-button" title="KÃ¶r omvÃ¤rldsbevakning nu"
          onclick="confirmAction('/run_user?email={{ user['Email'] }}', 'KÃ¶ra bevakning nu fÃ¶r {{ user['Name'] }}?')">â–¶ï¸</button>

        <a href="/edit_user?email={{ user['Email'] }}" title="Redigera anvÃ¤ndare">
          <button class="emoji-button">âœï¸</button>
        </a>

        <button class="emoji-button" title="Ta bort anvÃ¤ndare"
          onclick="confirmAction('/delete_user?email={{ user['Email'] }}', 'Ta bort anvÃ¤ndare {{ user['Name'] }}?')">ğŸ—‘</button>
      </td>
    </tr>
    {% endfor %}
  </table>

  <br>
  <a href="/add_user">â• LÃ¤gg till ny anvÃ¤ndare</a>
</body>
</html>
